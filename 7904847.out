[2024-12-12 19:16:05,161] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
Warning: The cache directory for DeepSpeed Triton autotune, /home/zhuxuekai/.triton/autotune, appears to be on an NFS system. While this is generally acceptable, if you experience slowdowns or hanging when DeepSpeed exits, it is recommended to set the TRITON_CACHE_DIR environment variable to a non-NFS path.
[2024-12-12 19:16:10,016][accelerate.utils.modeling][INFO] - We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
[2024-12-12 19:16:11,104][accelerate.utils.modeling][INFO] - We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/1002 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/1002 [00:00<?, ?it/s] Epoch 0:   0%|          | 1/1002 [13:41<228:31:45,  0.00it/s]Epoch 0:   0%|          | 1/1002 [13:41<228:31:52,  0.00it/s, v_num=664z, train/loss=2.43e+3]Epoch 0:   0%|          | 2/1002 [13:46<114:44:31,  0.00it/s, v_num=664z, train/loss=2.43e+3]Epoch 0:   0%|          | 2/1002 [13:46<114:44:41,  0.00it/s, v_num=664z, train/loss=481.0]  Epoch 0:   0%|          | 3/1002 [13:50<76:51:51,  0.00it/s, v_num=664z, train/loss=481.0] Epoch 0:   0%|          | 3/1002 [13:50<76:51:53,  0.00it/s, v_num=664z, train/loss=676.0]Epoch 0:   0%|          | 4/1002 [13:57<58:02:16,  0.00it/s, v_num=664z, train/loss=676.0]Epoch 0:   0%|          | 4/1002 [13:57<58:02:19,  0.00it/s, v_num=664z, train/loss=448.0]Epoch 0:   0%|          | 5/1002 [14:03<46:44:11,  0.01it/s, v_num=664z, train/loss=448.0]Epoch 0:   0%|          | 5/1002 [14:03<46:44:11,  0.01it/s, v_num=664z, train/loss=386.0]Epoch 0:   1%|          | 6/1002 [14:06<39:03:01,  0.01it/s, v_num=664z, train/loss=386.0]Epoch 0:   1%|          | 6/1002 [14:06<39:03:01,  0.01it/s, v_num=664z, train/loss=401.0]Epoch 0:   1%|          | 7/1002 [14:11<33:36:40,  0.01it/s, v_num=664z, train/loss=401.0]Epoch 0:   1%|          | 7/1002 [14:11<33:36:40,  0.01it/s, v_num=664z, train/loss=1.12e+3]Epoch 0:   1%|          | 8/1002 [14:16<29:33:37,  0.01it/s, v_num=664z, train/loss=1.12e+3]Epoch 0:   1%|          | 8/1002 [14:16<29:33:38,  0.01it/s, v_num=664z, train/loss=829.0]  Epoch 0:   1%|          | 9/1002 [14:20<26:22:40,  0.01it/s, v_num=664z, train/loss=829.0]Epoch 0:   1%|          | 9/1002 [14:20<26:22:42,  0.01it/s, v_num=664z, train/loss=282.0]Epoch 0:   1%|          | 10/1002 [14:26<23:52:04,  0.01it/s, v_num=664z, train/loss=282.0]Epoch 0:   1%|          | 10/1002 [14:26<23:52:04,  0.01it/s, v_num=664z, train/loss=401.0]Epoch 0:   1%|          | 11/1002 [14:31<21:49:14,  0.01it/s, v_num=664z, train/loss=401.0]Epoch 0:   1%|          | 11/1002 [14:31<21:49:15,  0.01it/s, v_num=664z, train/loss=462.0]Epoch 0:   1%|          | 12/1002 [14:35<20:03:55,  0.01it/s, v_num=664z, train/loss=462.0]Epoch 0:   1%|          | 12/1002 [14:35<20:03:55,  0.01it/s, v_num=664z, train/loss=122.0]Epoch 0:   1%|â–         | 13/1002 [14:40<18:36:23,  0.01it/s, v_num=664z, train/loss=122.0]Epoch 0:   1%|â–         | 13/1002 [14:40<18:36:25,  0.01it/s, v_num=664z, train/loss=680.0]Epoch 0:   1%|â–         | 14/1002 [14:44<17:20:42,  0.02it/s, v_num=664z, train/loss=680.0]Epoch 0:   1%|â–         | 14/1002 [14:44<17:20:42,  0.02it/s, v_num=664z, train/loss=417.0]Epoch 0:   1%|â–         | 15/1002 [14:51<16:17:26,  0.02it/s, v_num=664z, train/loss=417.0]Epoch 0:   1%|â–         | 15/1002 [14:51<16:17:26,  0.02it/s, v_num=664z, train/loss=742.0]Epoch 0:   2%|â–         | 16/1002 [14:56<15:20:47,  0.02it/s, v_num=664z, train/loss=742.0]Epoch 0:   2%|â–         | 16/1002 [14:56<15:20:47,  0.02it/s, v_num=664z, train/loss=261.0]Epoch 0:   2%|â–         | 17/1002 [15:01<14:30:35,  0.02it/s, v_num=664z, train/loss=261.0]Epoch 0:   2%|â–         | 17/1002 [15:01<14:30:35,  0.02it/s, v_num=664z, train/loss=177.0]Epoch 0:   2%|â–         | 18/1002 [15:06<13:46:15,  0.02it/s, v_num=664z, train/loss=177.0]Epoch 0:   2%|â–         | 18/1002 [15:06<13:46:16,  0.02it/s, v_num=664z, train/loss=157.0]Epoch 0:   2%|â–         | 19/1002 [15:10<13:05:31,  0.02it/s, v_num=664z, train/loss=157.0]Epoch 0:   2%|â–         | 19/1002 [15:10<13:05:31,  0.02it/s, v_num=664z, train/loss=326.0]Epoch 0:   2%|â–         | 20/1002 [15:17<12:30:43,  0.02it/s, v_num=664z, train/loss=326.0]Epoch 0:   2%|â–         | 20/1002 [15:17<12:30:44,  0.02it/s, v_num=664z, train/loss=701.0]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/20 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/20 [00:00<?, ?it/s][A
Validation DataLoader 0:   5%|â–Œ         | 1/20 [00:00<00:18,  1.01it/s][A
Validation DataLoader 0:  10%|â–ˆ         | 2/20 [00:01<00:17,  1.06it/s][A
Validation DataLoader 0:  15%|â–ˆâ–Œ        | 3/20 [00:02<00:16,  1.05it/s][A
Validation DataLoader 0:  20%|â–ˆâ–ˆ        | 4/20 [00:04<00:17,  0.94it/s][A
Validation DataLoader 0:  25%|â–ˆâ–ˆâ–Œ       | 5/20 [00:05<00:15,  0.98it/s][A
Validation DataLoader 0:  30%|â–ˆâ–ˆâ–ˆ       | 6/20 [00:06<00:14,  0.97it/s][A
Validation DataLoader 0:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 7/20 [00:06<00:12,  1.00it/s][A
Validation DataLoader 0:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 8/20 [00:08<00:13,  0.91it/s][A
Validation DataLoader 0:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 9/20 [00:09<00:11,  0.96it/s][A
Validation DataLoader 0:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 10/20 [00:10<00:10,  0.95it/s][A
Validation DataLoader 0:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 11/20 [00:11<00:09,  0.95it/s][A
Validation DataLoader 0:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 12/20 [00:12<00:08,  0.94it/s][A
Validation DataLoader 0:  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 13/20 [00:14<00:07,  0.91it/s][A
Validation DataLoader 0:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 14/20 [00:15<00:06,  0.91it/s][A
Validation DataLoader 0:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 15/20 [00:16<00:05,  0.88it/s][A
Validation DataLoader 0:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 16/20 [00:18<00:04,  0.85it/s][A
Validation DataLoader 0:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 17/20 [00:20<00:03,  0.83it/s][A
Validation DataLoader 0:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 18/20 [00:21<00:02,  0.82it/s][A
Validation DataLoader 0:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 19/20 [00:23<00:01,  0.82it/s][A
Validation DataLoader 0: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 20/20 [00:25<00:00,  0.79it/s][A
                                                                        [AEpoch 0:   2%|â–         | 20/1002 [17:21<14:11:54,  0.02it/s, v_num=664z, train/loss=701.0, val/loss=274.0]Epoch 0:   2%|â–         | 21/1002 [17:48<13:51:55,  0.02it/s, v_num=664z, train/loss=701.0, val/loss=274.0]Epoch 0:   2%|â–         | 21/1002 [17:48<13:51:55,  0.02it/s, v_num=664z, train/loss=152.0, val/loss=274.0]Epoch 0:   2%|â–         | 22/1002 [17:53<13:17:12,  0.02it/s, v_num=664z, train/loss=152.0, val/loss=274.0]Epoch 0:   2%|â–         | 22/1002 [17:53<13:17:13,  0.02it/s, v_num=664z, train/loss=1.59e+3, val/loss=274.0]Epoch 0:   2%|â–         | 23/1002 [18:01<12:46:54,  0.02it/s, v_num=664z, train/loss=1.59e+3, val/loss=274.0]Epoch 0:   2%|â–         | 23/1002 [18:01<12:46:54,  0.02it/s, v_num=664z, train/loss=383.0, val/loss=274.0]  Epoch 0:   2%|â–         | 24/1002 [18:09<12:19:36,  0.02it/s, v_num=664z, train/loss=383.0, val/loss=274.0]Epoch 0:   2%|â–         | 24/1002 [18:09<12:19:37,  0.02it/s, v_num=664z, train/loss=484.0, val/loss=274.0]Epoch 0:   2%|â–         | 25/1002 [18:15<11:53:16,  0.02it/s, v_num=664z, train/loss=484.0, val/loss=274.0]Epoch 0:   2%|â–         | 25/1002 [18:15<11:53:16,  0.02it/s, v_num=664z, train/loss=335.0, val/loss=274.0]Epoch 0:   3%|â–Ž         | 26/1002 [18:20<11:28:17,  0.02it/s, v_num=664z, train/loss=335.0, val/loss=274.0]Epoch 0:   3%|â–Ž         | 26/1002 [18:20<11:28:17,  0.02it/s, v_num=664z, train/loss=890.0, val/loss=274.0]Epoch 0:   3%|â–Ž         | 27/1002 [18:24<11:04:59,  0.02it/s, v_num=664z, train/loss=890.0, val/loss=274.0]Epoch 0:   3%|â–Ž         | 27/1002 [18:24<11:04:59,  0.02it/s, v_num=664z, train/loss=115.0, val/loss=274.0]Epoch 0:   3%|â–Ž         | 28/1002 [18:28<10:42:24,  0.03it/s, v_num=664z, train/loss=115.0, val/loss=274.0]Epoch 0:   3%|â–Ž         | 28/1002 [18:28<10:42:24,  0.03it/s, v_num=664z, train/loss=75.30, val/loss=274.0]Epoch 0:   3%|â–Ž         | 29/1002 [18:33<10:22:37,  0.03it/s, v_num=664z, train/loss=75.30, val/loss=274.0]Epoch 0:   3%|â–Ž         | 29/1002 [18:33<10:22:37,  0.03it/s, v_num=664z, train/loss=563.0, val/loss=274.0]Epoch 0:   3%|â–Ž         | 30/1002 [18:37<10:03:40,  0.03it/s, v_num=664z, train/loss=563.0, val/loss=274.0]Epoch 0:   3%|â–Ž         | 30/1002 [18:37<10:03:40,  0.03it/s, v_num=664z, train/loss=299.0, val/loss=274.0]Epoch 0:   3%|â–Ž         | 31/1002 [18:44<9:46:49,  0.03it/s, v_num=664z, train/loss=299.0, val/loss=274.0] Epoch 0:   3%|â–Ž         | 31/1002 [18:44<9:46:49,  0.03it/s, v_num=664z, train/loss=409.0, val/loss=274.0]Epoch 0:   3%|â–Ž         | 32/1002 [18:47<9:29:24,  0.03it/s, v_num=664z, train/loss=409.0, val/loss=274.0]Epoch 0:   3%|â–Ž         | 32/1002 [18:47<9:29:24,  0.03it/s, v_num=664z, train/loss=69.70, val/loss=274.0]Epoch 0:   3%|â–Ž         | 33/1002 [18:51<9:13:41,  0.03it/s, v_num=664z, train/loss=69.70, val/loss=274.0]Epoch 0:   3%|â–Ž         | 33/1002 [18:51<9:13:41,  0.03it/s, v_num=664z, train/loss=212.0, val/loss=274.0]Epoch 0:   3%|â–Ž         | 34/1002 [18:57<8:59:59,  0.03it/s, v_num=664z, train/loss=212.0, val/loss=274.0]Epoch 0:   3%|â–Ž         | 34/1002 [18:57<8:59:59,  0.03it/s, v_num=664z, train/loss=767.0, val/loss=274.0]Epoch 0:   3%|â–Ž         | 35/1002 [19:02<8:46:17,  0.03it/s, v_num=664z, train/loss=767.0, val/loss=274.0]Epoch 0:   3%|â–Ž         | 35/1002 [19:02<8:46:17,  0.03it/s, v_num=664z, train/loss=120.0, val/loss=274.0]Epoch 0:   4%|â–Ž         | 36/1002 [19:09<8:34:18,  0.03it/s, v_num=664z, train/loss=120.0, val/loss=274.0]Epoch 0:   4%|â–Ž         | 36/1002 [19:09<8:34:18,  0.03it/s, v_num=664z, train/loss=944.0, val/loss=274.0]Epoch 0:   4%|â–Ž         | 37/1002 [19:15<8:22:11,  0.03it/s, v_num=664z, train/loss=944.0, val/loss=274.0]Epoch 0:   4%|â–Ž         | 37/1002 [19:15<8:22:11,  0.03it/s, v_num=664z, train/loss=336.0, val/loss=274.0]Epoch 0:   4%|â–         | 38/1002 [19:18<8:09:53,  0.03it/s, v_num=664z, train/loss=336.0, val/loss=274.0]Epoch 0:   4%|â–         | 38/1002 [19:18<8:09:53,  0.03it/s, v_num=664z, train/loss=920.0, val/loss=274.0]Epoch 0:   4%|â–         | 39/1002 [19:23<7:58:41,  0.03it/s, v_num=664z, train/loss=920.0, val/loss=274.0]Epoch 0:   4%|â–         | 39/1002 [19:23<7:58:41,  0.03it/s, v_num=664z, train/loss=177.0, val/loss=274.0]Epoch 0:   4%|â–         | 40/1002 [19:29<7:48:41,  0.03it/s, v_num=664z, train/loss=177.0, val/loss=274.0]Epoch 0:   4%|â–         | 40/1002 [19:29<7:48:41,  0.03it/s, v_num=664z, train/loss=84.80, val/loss=274.0]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/20 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/20 [00:00<?, ?it/s][A
Validation DataLoader 0:   5%|â–Œ         | 1/20 [00:01<00:19,  0.96it/s][A
Validation DataLoader 0:  10%|â–ˆ         | 2/20 [00:02<00:18,  0.96it/s][A
Validation DataLoader 0:  15%|â–ˆâ–Œ        | 3/20 [00:03<00:17,  0.98it/s][A
Validation DataLoader 0:  20%|â–ˆâ–ˆ        | 4/20 [00:04<00:16,  0.97it/s][A
Validation DataLoader 0:  25%|â–ˆâ–ˆâ–Œ       | 5/20 [00:05<00:17,  0.86it/s][A
Validation DataLoader 0:  30%|â–ˆâ–ˆâ–ˆ       | 6/20 [00:07<00:16,  0.83it/s][A
Validation DataLoader 0:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 7/20 [00:08<00:15,  0.84it/s][A
Validation DataLoader 0:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 8/20 [00:10<00:15,  0.77it/s][A
Validation DataLoader 0:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 9/20 [00:10<00:13,  0.82it/s][A
Validation DataLoader 0:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 10/20 [00:12<00:12,  0.83it/s][A
Validation DataLoader 0:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 11/20 [00:13<00:10,  0.83it/s][A
Validation DataLoader 0:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 12/20 [00:14<00:09,  0.84it/s][A
Validation DataLoader 0:  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 13/20 [00:15<00:08,  0.81it/s][A
Validation DataLoader 0:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 14/20 [00:16<00:07,  0.84it/s][A
Validation DataLoader 0:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 15/20 [00:17<00:05,  0.84it/s][A
Validation DataLoader 0:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 16/20 [00:19<00:04,  0.83it/s][A
Validation DataLoader 0:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 17/20 [00:20<00:03,  0.83it/s][A
Validation DataLoader 0:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 18/20 [00:21<00:02,  0.83it/s][A
Validation DataLoader 0:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 19/20 [00:22<00:01,  0.83it/s][A
Validation DataLoader 0: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 20/20 [00:23<00:00,  0.85it/s][A
                                                                        [AEpoch 0:   4%|â–         | 40/1002 [20:35<8:15:05,  0.03it/s, v_num=664z, train/loss=84.80, val/loss=231.0]Epoch 0:   4%|â–         | 41/1002 [21:17<8:18:56,  0.03it/s, v_num=664z, train/loss=84.80, val/loss=231.0]Epoch 0:   4%|â–         | 41/1002 [21:17<8:18:56,  0.03it/s, v_num=664z, train/loss=76.40, val/loss=231.0]Epoch 0:   4%|â–         | 42/1002 [21:23<8:08:52,  0.03it/s, v_num=664z, train/loss=76.40, val/loss=231.0]Epoch 0:   4%|â–         | 42/1002 [21:23<8:08:52,  0.03it/s, v_num=664z, train/loss=141.0, val/loss=231.0]Epoch 0:   4%|â–         | 43/1002 [21:27<7:58:34,  0.03it/s, v_num=664z, train/loss=141.0, val/loss=231.0]Epoch 0:   4%|â–         | 43/1002 [21:27<7:58:34,  0.03it/s, v_num=664z, train/loss=246.0, val/loss=231.0]Epoch 0:   4%|â–         | 44/1002 [21:31<7:48:46,  0.03it/s, v_num=664z, train/loss=246.0, val/loss=231.0]Epoch 0:   4%|â–         | 44/1002 [21:31<7:48:47,  0.03it/s, v_num=664z, train/loss=255.0, val/loss=231.0]Epoch 0:   4%|â–         | 45/1002 [21:36<7:39:29,  0.03it/s, v_num=664z, train/loss=255.0, val/loss=231.0]Epoch 0:   4%|â–         | 45/1002 [21:36<7:39:29,  0.03it/s, v_num=664z, train/loss=459.0, val/loss=231.0]Epoch 0:   5%|â–         | 46/1002 [21:42<7:31:16,  0.04it/s, v_num=664z, train/loss=459.0, val/loss=231.0]Epoch 0:   5%|â–         | 46/1002 [21:42<7:31:16,  0.04it/s, v_num=664z, train/loss=495.0, val/loss=231.0][1;34mwandb[0m: ðŸš€ View run [33m2024-12-12_19-16-07[0m at: [34mhttps://wandb.ai/xuekai-zhu/gfn4ntp/runs/sp3z664z[0m
[1;34mwandb[0m: Find logs at: [1;35m../../../../../../tmp/wandb/run-20241212_191613-sp3z664z/logs[0m
Epoch 0:   5%|â–         | 46/1002 [23:10<8:01:42,  0.03it/s, v_num=664z, train/loss=495.0, val/loss=231.0]